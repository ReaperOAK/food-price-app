"use strict";(self.webpackChunkfood_price_app=self.webpackChunkfood_price_app||[]).push([[4488],{4488:(t,e,a)=>{a.d(e,{Hu:()=>l,I3:()=>h});var n=a(9379),o=a(3986);const c=["timeout","retries","cacheBust","useCache"],r=new Map,s=1e4,i=3,h=()=>{r.clear()},l=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const a=(0,n.A)((0,n.A)({method:t?"POST":"GET",headers:{"Content-Type":"application/json"}},e),{},{cacheBust:e.forceRefresh||!1});t&&(a.body=JSON.stringify(t));const h=await async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{timeout:a=s,retries:h=i,cacheBust:l=!1,useCache:u=!0}=e,p=(0,o.A)(e,c);if(u&&!l){const e="".concat(t,"_").concat(JSON.stringify(p)),a=r.get(e);if(a&&Date.now()-a.timestamp<3e5)return a.data}let d=t;if(l){const e=t.includes("?")?"&":"?";d="".concat(t).concat(e,"nocache=").concat(Date.now(),"&t=").concat(Math.random())}let w=null;for(let o=0;o<h;o++)try{const e=new AbortController,o=setTimeout((()=>e.abort()),a),c=await fetch(d,(0,n.A)((0,n.A)({},p),{},{signal:e.signal,headers:(0,n.A)({"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"},p.headers)}));if(clearTimeout(o),!c.ok)throw new Error("HTTP ".concat(c.status,": ").concat(c.statusText));const s=await c.json();if(u){const e="".concat(t,"_").concat(JSON.stringify(p));r.set(e,{data:s,timestamp:Date.now()})}return s}catch(f){if(w=f,"AbortError"===f.name||o===h-1)break;const t=1e3*Math.pow(2,o);await new Promise((e=>setTimeout(e,t)))}throw w}("/php/api/rates/get_latest_rates.php",a);return Array.isArray(h)?h.map((t=>{const e=parseFloat(t.rate);return{id:t.id||String(Math.random()),city:t.city||"Unknown",state:t.state||"Unknown",date:t.date||(new Date).toISOString().split("T")[0],rate:isNaN(e)?0:e}})):[]}catch(a){throw new Error("Failed to fetch latest rates: ".concat(a.message))}}}}]);