"use strict";(self.webpackChunkfood_price_app=self.webpackChunkfood_price_app||[]).push([[5549,9676],{3990:(t,e,a)=>{a.d(e,{f:()=>s});var r=a(9379),n=a(9950),c=a(5530);const s=(t,e)=>{const[a,s]=(0,n.useState)(t||""),[o,l]=(0,n.useState)(e||""),[i,u]=(0,n.useState)([]),[h,p]=(0,n.useState)([]),[f,w]=(0,n.useState)(!0),[y,d]=(0,n.useState)(null),[g,m]=(0,n.useState)(0),[A,C]=(0,n.useState)(!1),S=(0,n.useRef)(null),b=(0,n.useRef)(null),k=t=>{const e=t.includes("?")?"&":"?";return"".concat(t).concat(e,"nocache=").concat(Date.now())},_=(0,n.useCallback)((async function(t){let e=null;for(var a=arguments.length,r=new Array(a>1?a-1:0),n=1;n<a;n++)r[n-1]=arguments[n];for(let c=0;c<3;c++)try{const e=new AbortController;b.current=e;const a=setTimeout((()=>{e.abort()}),1e4),n=await t(...r,{signal:e.signal});if(clearTimeout(a),Array.isArray(n)&&n.length>=0)return n;throw new Error("Invalid data format received")}catch(y){if(e=y,"AbortError"===y.name)throw y;c<2&&await new Promise((t=>setTimeout(t,1e3*Math.pow(2,c))))}throw e}),[]),v=(0,n.useCallback)((async function(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{let n;if(t||e){const a=new URLSearchParams;t&&a.append("city",t.trim()),e&&a.append("state",e.trim()),n="/php/api/rates/get_rates.php?".concat(a.toString())}else n="/php/api/rates/get_latest_rates.php";g>0&&(n=k(n));const c=await fetch(n,{signal:a.signal,headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(!c.ok)throw new Error("HTTP error! status: ".concat(c.status));const s=await c.json();return Array.isArray(s)?s.map((t=>{const e=parseFloat(t.rate);return(0,r.A)((0,r.A)({},t),{},{rate:isNaN(e)?0:e})})):[]}catch(y){throw y}}),[g]),P=(0,n.useCallback)((async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let e="/php/api/rates/get_special_rates.php";g>0&&(e=k(e));const a=await fetch(e,{signal:t.signal,headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(!a.ok)throw new Error("HTTP error! status: ".concat(a.status));const n=await a.json();return Array.isArray(n)?n.map((t=>(0,r.A)((0,r.A)({},t),{},{rate:parseFloat(t.rate)}))):[]}catch(y){throw y}}),[g]),R=(0,n.useCallback)((()=>{g<3&&(m((t=>t+1)),d(null))}),[g]),T=(0,n.useCallback)((async()=>{b.current&&b.current.abort();const t=Date.now();S.current=t,w(!0),d(null);try{let e=a,r=o;if(a&&!o)try{const t=await(0,c.Si)(a);t&&t.state&&(r=t.state,l(t.state))}catch(y){}if(S.current!==t)return;if(e||r){const[a,n]=await Promise.all([_(v,e,r),_(P)]);S.current===t&&(u(a||[]),p(n||[]),m(0))}else S.current===t&&(u([]),p([]))}catch(y){S.current===t&&(d(y),u([]),p([]))}finally{S.current===t&&(w(!1),C(!0))}}),[a,o,_,v,P]);return(0,n.useEffect)((()=>(a||o?T():(w(!1),C(!0),u([]),p([])),()=>{b.current&&b.current.abort()})),[a,o,g,T]),(0,n.useEffect)((()=>{}),[g]),{selectedCity:a,selectedState:o,setSelectedCity:s,setSelectedState:l,eggRates:i,specialRates:h,loading:f,locationReady:A,error:y,retryCount:g,retryFetch:R,canRetry:g<3}}},9676:(t,e,a)=>{a.d(e,{$:()=>r});const r=t=>"N/A"===t||null===t||void 0===t?"N/A":"number"===typeof t?t.toFixed(2):t}}]);