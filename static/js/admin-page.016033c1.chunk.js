"use strict";(self.webpackChunkfood_price_app=self.webpackChunkfood_price_app||[]).push([[270,832],{6853:(e,t,a)=>{a.r(t),a.d(t,{default:()=>r});var s=a(9379),n=(a(5043),a(579));const r=e=>{let{eggRate:t,setEggRate:a,handleSubmit:r,handleSelectAll:l,handleCopyPreviousRates:o}=e;return(0,n.jsxs)("form",{onSubmit:r,className:"mb-6 grid grid-cols-1 gap-4",children:[(0,n.jsx)("button",{type:"button",onClick:l,className:"bg-green-600 text-white p-3 rounded w-full hover:bg-green-700 transition",children:"Select All Cities"}),(0,n.jsx)("input",{type:"date",value:t.date,onChange:e=>a((0,s.A)((0,s.A)({},t),{},{date:e.target.value})),className:"border border-gray-300 p-3 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500 transition",required:!0}),(0,n.jsx)("input",{type:"number",placeholder:"Rate",value:t.rate,onChange:e=>a((0,s.A)((0,s.A)({},t),{},{rate:e.target.value})),className:"border border-gray-300 p-3 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500 transition",required:!0}),(0,n.jsx)("button",{type:"submit",className:"bg-blue-600 text-white p-3 rounded w-full hover:bg-blue-700 transition",children:"Update Rates"}),(0,n.jsx)("button",{type:"button",onClick:o,className:"bg-yellow-600 text-white p-3 rounded w-full hover:bg-yellow-700 transition",children:"Copy Previous Rates"})]})}},5927:(e,t,a)=>{a.r(t),a.d(t,{default:()=>l});var s=a(5043),n=a(579);const r=e=>{let{rates:t=[],itemsPerPage:a=10,showAdmin:r=!1,onDelete:l,onEdit:o,handleSort:i,showState:c=!1,showDate:d=!1,showPriceColumns:u=!0,selectedCity:h="",selectedState:p=""}=e;const[g,m]=(0,s.useState)(1),[y,b]=(0,s.useState)({key:"city",direction:"ascending"}),[x,f]=(0,s.useState)(!1),j=(0,s.useCallback)((e=>{i?i(e):b((t=>({key:e,direction:t.key===e&&"ascending"===t.direction?"descending":"ascending"})))}),[i]),v=(0,s.useMemo)((()=>i?t:[...t].sort(((e,t)=>{const a=e[y.key],s=t[y.key];return"ascending"===y.direction?a<s?-1:a>s?1:0:a>s?-1:a<s?1:0}))),[t,y,i]),S=(0,s.useCallback)((e=>{m(e)}),[]),N=Math.ceil(((null===t||void 0===t?void 0:t.length)||0)/a),w=g*a,C=w-a,k=v.slice(C,w);(0,s.useEffect)((()=>{const e=new IntersectionObserver((t=>{let[a]=t;a.isIntersecting&&(f(!0),e.disconnect())}),{threshold:.1}),t=document.querySelector(".rate-table-container");return t&&e.observe(t),()=>e.disconnect()}),[]);const A=(0,s.useCallback)((()=>{const e=[];for(let t=1;t<=N;t++)e.push((0,n.jsx)("button",{onClick:()=>S(t),className:"px-3 py-1 mx-1 rounded ".concat(g===t?"bg-blue-600 text-white":"bg-gray-200 hover:bg-gray-300"),"aria-label":"Page ".concat(t),children:t},t));return e}),[g,N,S]),O=(0,s.useCallback)((()=>{var e;if(!h)return null;const t={"@context":"https://schema.org","@type":"LocalBusiness",name:"Egg Market ".concat(h),description:"Find today's egg rates in ".concat(h,", ").concat(p,". Updated daily NECC egg prices and wholesale egg rates."),address:{"@type":"PostalAddress",addressLocality:h,addressRegion:p,addressCountry:"IN"},url:"https://todayeggrates.com/".concat(h.toLowerCase(),"-egg-rate"),aggregateRating:{"@type":"AggregateRating",ratingValue:"4.8",ratingCount:"254"},priceRange:"\u20b9\u20b9",offers:{"@type":"Offer",itemOffered:{"@type":"Product",name:"Eggs",description:"Fresh eggs in ".concat(h,", ").concat(p),offers:{"@type":"Offer",price:(null===(e=v[0])||void 0===e?void 0:e.rate)||0,priceCurrency:"INR",availability:"https://schema.org/InStock",priceValidUntil:new Date((new Date).setDate((new Date).getDate()+1)).toISOString().split("T")[0]}}}};return(0,n.jsx)("script",{type:"application/ld+json",children:JSON.stringify(t)})}),[h,p,v]);return t&&0!==t.length?(0,n.jsx)("div",{className:"rate-table-container",children:x&&(0,n.jsxs)(n.Fragment,{children:[O(),(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"min-w-full bg-white border-collapse",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"bg-gray-50",children:[c&&(0,n.jsxs)("th",{className:"px-4 py-2 text-left cursor-pointer hover:bg-gray-100",onClick:()=>j("state"),children:["State","state"===y.key&&(0,n.jsx)("span",{className:"ml-1",children:"ascending"===y.direction?"\u2191":"\u2193"})]}),(0,n.jsxs)("th",{className:"px-4 py-2 text-left cursor-pointer hover:bg-gray-100",onClick:()=>j("city"),children:["City","city"===y.key&&(0,n.jsx)("span",{className:"ml-1",children:"ascending"===y.direction?"\u2191":"\u2193"})]}),u&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("th",{className:"px-4 py-2 text-left cursor-pointer hover:bg-gray-100",onClick:()=>j("rate"),children:["Rate","rate"===y.key&&(0,n.jsx)("span",{className:"ml-1",children:"ascending"===y.direction?"\u2191":"\u2193"})]}),(0,n.jsxs)("th",{className:"px-4 py-2 text-left cursor-pointer hover:bg-gray-100",onClick:()=>j("retailPrice"),children:["Retail Price","retailPrice"===y.key&&(0,n.jsx)("span",{className:"ml-1",children:"ascending"===y.direction?"\u2191":"\u2193"})]})]}),d&&(0,n.jsxs)("th",{className:"px-4 py-2 text-left cursor-pointer hover:bg-gray-100",onClick:()=>j("date"),children:["Date","date"===y.key&&(0,n.jsx)("span",{className:"ml-1",children:"ascending"===y.direction?"\u2191":"\u2193"})]}),r&&(0,n.jsx)("th",{className:"px-4 py-2 text-left",children:"Actions"})]})}),(0,n.jsx)("tbody",{children:k.map(((e,t)=>(0,n.jsxs)("tr",{className:t%2===0?"bg-white":"bg-gray-50",children:[c&&(0,n.jsx)("td",{className:"px-4 py-2",children:e.state}),(0,n.jsx)("td",{className:"px-4 py-2",children:e.city}),d&&(0,n.jsx)("td",{className:"px-4 py-2",children:new Date(e.date).toLocaleDateString()}),u&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("td",{className:"px-4 py-2",children:["\u20b9",e.rate]}),(0,n.jsxs)("td",{className:"px-4 py-2",children:["\u20b9",(30*e.rate).toFixed(2)]})]}),r&&(0,n.jsxs)("td",{className:"px-4 py-2",children:[(0,n.jsx)("button",{onClick:()=>o(e),className:"mr-2 text-blue-600 hover:text-blue-800",children:"Edit"}),(0,n.jsx)("button",{onClick:()=>l(e.id),className:"text-red-600 hover:text-red-800",children:"Delete"})]})]},e.id||t)))})]})}),(0,n.jsx)("div",{className:"flex justify-center mt-4",children:A()})]})}):(0,n.jsx)("div",{className:"text-center p-4",children:(0,n.jsx)("p",{className:"text-gray-600",children:"No rates available at the moment."})})},l=(0,s.memo)(r)},3102:(e,t,a)=>{a.r(t),a.d(t,{default:()=>y});var s=a(5043),n=a(4672),r=a(3216),l=a(5475),o=a(579);const i=e=>{let{setIsAuthenticated:t}=e;const a=(0,r.Zp)();return(0,o.jsx)("nav",{className:"bg-gray-800 p-4 shadow-lg",children:(0,o.jsxs)("div",{className:"container mx-auto flex justify-between items-center",children:[(0,o.jsx)("div",{children:(0,o.jsx)(l.N_,{to:"/admin",className:"text-white text-2xl font-bold",children:"Admin Dashboard"})}),(0,o.jsx)("div",{className:"flex space-x-4",children:(0,o.jsx)("button",{onClick:()=>{t(!1),a("/login")},className:"text-white bg-red-600 hover:bg-red-700 px-4 py-2 rounded transition duration-150 ease-in-out",children:"Logout"})})]})})},c=e=>{let{states:t,selectedState:a,handleStateChange:s}=e;return(0,o.jsx)(n.Ay,{options:t,value:a,onChange:s,className:"w-full mb-4",placeholder:"Select State"})};var d=a(9379);const u=e=>{let{options:t,selectedOptions:a,setSelectedOptions:s}=e;const r=Array.from(new Set(t.map((e=>e.value)))).map((e=>t.find((t=>t.value===e))));return(0,o.jsx)(n.Ay,{isMulti:!0,options:r,value:a,onChange:s,className:"w-full",styles:{control:e=>(0,d.A)((0,d.A)({},e),{},{backgroundColor:"white",borderColor:"transparent",boxShadow:"none","&:hover":{borderColor:"transparent"},padding:"0.5rem",borderRadius:"0.375rem"}),menu:e=>(0,d.A)((0,d.A)({},e),{},{zIndex:9999}),placeholder:e=>(0,d.A)((0,d.A)({},e),{},{color:"#A0AEC0"})},placeholder:"Select Cities, States"})};var h=a(6853);const p=e=>{let{newState:t,setNewState:a,handleAddState:s}=e;return(0,o.jsxs)("form",{onSubmit:s,className:"mb-6 grid grid-cols-1 gap-4",children:[(0,o.jsx)("input",{type:"text",placeholder:"New State",value:t,onChange:e=>a(e.target.value),className:"border border-gray-300 p-3 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500 transition",required:!0}),(0,o.jsx)("button",{type:"submit",className:"bg-blue-600 text-white p-3 rounded w-full hover:bg-blue-700 transition",children:"Add State"})]})},g=e=>{let{states:t,newCity:a,setNewCity:s,newCityState:r,setNewCityState:l,handleAddCity:i}=e;return(0,o.jsxs)("form",{onSubmit:i,className:"mb-6 grid grid-cols-1 gap-4",children:[(0,o.jsx)(n.Ay,{options:t,value:r,onChange:l,className:"w-full mb-4",placeholder:"Select State for New City"}),(0,o.jsx)("input",{type:"text",placeholder:"New City",value:a,onChange:e=>s(e.target.value),className:"border border-gray-300 p-3 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500 transition",required:!0}),(0,o.jsx)("button",{type:"submit",className:"bg-blue-600 text-white p-3 rounded w-full hover:bg-blue-700 transition",children:"Add City"})]})};var m=a(5927);const y=e=>{let{setIsAuthenticated:t}=e;const a=(new Date).toISOString().split("T")[0],[r,l]=(0,s.useState)({date:a,rate:""}),[d,y]=(0,s.useState)([]),[b,x]=(0,s.useState)([]),[f,j]=(0,s.useState)([]),[v,S]=(0,s.useState)(!0),[N,w]=(0,s.useState)(null),[C,k]=(0,s.useState)({key:"city",direction:"ascending"}),[A,O]=(0,s.useState)([]),[E,R]=(0,s.useState)(null),[_,P]=(0,s.useState)(""),[D,T]=(0,s.useState)(""),[I,F]=(0,s.useState)(null),[J,L]=(0,s.useState)(""),[M,q]=(0,s.useState)(null),[U,V]=(0,s.useState)(null),[z,B]=(0,s.useState)(a),Z=(0,s.useCallback)((()=>{S(!0),fetch("/php/api/rates/get_all_rates.php?date=".concat(z)).then((e=>e.json())).then((e=>{j(e),S(!1)})).catch((e=>{console.error("Error fetching rates:",e),w(e),S(!1)}))}),[z]),G=(0,s.useCallback)((()=>{fetch("/php/api/location/get_states_and_cities.php").then((e=>e.json())).then((e=>{const t=[],a=[];for(const s in e)a.push({value:s,label:s}),t.push({value:s,label:s,type:"state"}),e[s].forEach((e=>{t.push({value:"".concat(e,"-").concat(s),label:"".concat(e,", ").concat(s),type:"city"})}));x(t),O(a)})).catch((e=>console.error("Error fetching states and cities:",e)))}),[]);(0,s.useEffect)((()=>{Z()}),[Z]),(0,s.useEffect)((()=>{G()}),[G]);const H=s.useMemo((()=>{let e=[...f];return e.sort(((e,t)=>e[C.key]<t[C.key]?"ascending"===C.direction?-1:1:e[C.key]>t[C.key]?"ascending"===C.direction?1:-1:0)),e}),[f,C]),K=()=>{l({date:a,rate:""}),y([]),R(null),L(""),q(null),V(null),P(""),T(""),F(null)};return v?(0,o.jsx)("div",{children:"Loading..."}):N?(0,o.jsxs)("div",{children:["Error loading data: ",N.message]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i,{setIsAuthenticated:t}),(0,o.jsx)("div",{className:"p-6 bg-gray-100 min-h-screen",children:(0,o.jsxs)("div",{className:"max-w-4xl mx-auto bg-white p-8 rounded-lg shadow-md",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold mb-6 text-center text-blue-600",children:"Admin Egg Rate Management"}),(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)(c,{states:A,selectedState:E,handleStateChange:e=>{R(e),y([]);const t=b.filter((t=>"city"===t.type&&t.label.includes(e.value)));y(t)}}),(0,o.jsx)(u,{options:b,selectedOptions:d,setSelectedOptions:y}),(0,o.jsx)(h.default,{eggRate:r,setEggRate:l,handleSubmit:e=>{e.preventDefault();const t=d.map((e=>{const[t,a]="city"===e.type?e.label.split(", "):[null,e.value];return{city:t,state:a||"",date:r.date,rate:r.rate,type:e.type}}));fetch("/php/api/rates/update_multiple_rates.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.json())).then((e=>{Z(),K()})).catch((e=>console.error("Error submitting data:",e)))},handleSelectAll:()=>{const e=b.filter((e=>"city"===e.type));y(e)},handleCopyPreviousRates:()=>{if(0===d.length)return void alert("Please select at least one city.");(async()=>{const e=d.filter((e=>"city"===e.type)).map((e=>{const[t,a]=e.label.split(", ");return{city:t,state:a}}));console.log("Selected cities for updating rates:",e);const t=await(async e=>{console.log("Fetching latest rates for cities:",e);const t=await fetch("/php/api/rates/get_latest_rates.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await t.json();return console.log("Fetched latest rates:",a),a})(e),a=t.map((e=>({city:e.city,state:e.state,date:r.date,rate:e.rate||r.rate,type:"city"})));console.log("Payload for updating rates:",a),fetch("/php/api/rates/update_multiple_rates.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((e=>e.json())).then((e=>{console.log("Response from updating rates:",e),Z(),K()})).catch((e=>console.error("Error submitting data:",e)))})()}}),(0,o.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-blue-600",children:"Add New State"}),(0,o.jsx)(p,{newState:_,setNewState:P,handleAddState:e=>{e.preventDefault(),fetch("/php/api/location/add_state_city.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"state",name:_})}).then((e=>e.json())).then((e=>{e.success?(G(),P("")):alert(e.error)})).catch((e=>console.error("Error adding state:",e)))}}),(0,o.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-blue-600",children:"Add New City"}),(0,o.jsx)(g,{states:A,newCity:D,setNewCity:T,newCityState:I,setNewCityState:F,handleAddCity:e=>{e.preventDefault(),fetch("/php/api/location/add_state_city.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"city",name:D,state:I.value})}).then((e=>e.json())).then((e=>{e.success?(G(),T(""),F(null)):alert(e.error)})).catch((e=>console.error("Error adding city:",e)))}}),(0,o.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-blue-600",children:"Remove State"}),(0,o.jsxs)("form",{onSubmit:e=>{e.preventDefault(),fetch("/php/api/location/remove_state_city.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"state",name:J})}).then((e=>e.json())).then((e=>{e.success?(G(),L("")):alert(e.error)})).catch((e=>console.error("Error removing state:",e)))},className:"mb-6 grid grid-cols-1 gap-4",children:[(0,o.jsx)(n.Ay,{options:A,value:A.find((e=>e.value===J)),onChange:e=>L(e.value),className:"w-full mb-4",placeholder:"Select State to Remove"}),(0,o.jsx)("button",{type:"submit",className:"bg-red-600 text-white p-3 rounded w-full hover:bg-red-700 transition",children:"Remove State"})]}),(0,o.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-blue-600",children:"Remove City"}),(0,o.jsxs)("form",{onSubmit:e=>{e.preventDefault(),fetch("/php/api/location/remove_state_city.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"city",name:M.label.split(", ")[0],state:U.value})}).then((e=>e.json())).then((e=>{e.success?(G(),q(null),V(null)):alert(e.error)})).catch((e=>console.error("Error removing city:",e)))},className:"mb-6 grid grid-cols-1 gap-4",children:[(0,o.jsx)(n.Ay,{options:A,value:A.find((e=>e.value===(null===U||void 0===U?void 0:U.value))),onChange:V,className:"w-full mb-4",placeholder:"Select State for City to Remove"}),(0,o.jsx)(n.Ay,{options:b.filter((e=>"city"===e.type&&e.label.includes(null===U||void 0===U?void 0:U.value))),value:M,onChange:q,className:"w-full mb-4",placeholder:"Select City to Remove"}),(0,o.jsx)("button",{type:"submit",className:"bg-red-600 text-white p-3 rounded w-full hover:bg-red-700 transition",children:"Remove City"})]}),(0,o.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-blue-600",children:"Current Egg Rates"}),(0,o.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"date",children:"Select Date"}),(0,o.jsx)("input",{type:"date",id:"date",value:z,onChange:e=>B(e.target.value),className:"border border-gray-300 p-3 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500 transition"})]}),"          ",(0,o.jsx)(m.default,{rates:H,showAdmin:!0,showState:!0,showDate:!0,showChart:!1,showPriceColumns:!1,handleSort:e=>{let t="ascending";C.key===e&&"ascending"===C.direction&&(t="descending"),k({key:e,direction:t})},onEdit:e=>{const t=f.map((t=>t.id===e.id?e:t));j(t),fetch("/php/api/rates/update_rate.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{e.success?Z():console.error("Error updating rate:",e.error)})).catch((e=>console.error("Error updating rate:",e)))},onDelete:e=>{fetch("/php/api/rates/delete_rate.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id})}).then((e=>e.json())).then((e=>{Z()})).catch((e=>console.error("Error deleting item:",e)))}})]})})]})}}}]);
//# sourceMappingURL=admin-page.016033c1.chunk.js.map