"use strict";(self.webpackChunkfood_price_app=self.webpackChunkfood_price_app||[]).push([[5549,9676],{3990:(t,e,r)=>{r.d(e,{f:()=>c});var a=r(9379),n=r(9950),s=r(5530);const c=(t,e)=>{const[r,c]=(0,n.useState)(t||""),[o,l]=(0,n.useState)(e||""),[i,u]=(0,n.useState)([]),[h,p]=(0,n.useState)([]),[f,w]=(0,n.useState)(!0),[y,d]=(0,n.useState)(null),[g,m]=(0,n.useState)(0),[S,A]=(0,n.useState)(!1),C=(0,n.useRef)(null),b=(0,n.useRef)(null),k=t=>{const e=t.includes("?")?"&":"?";return"".concat(t).concat(e,"nocache=").concat(Date.now())},T=(0,n.useCallback)((async function(t){let e=null;for(var r=arguments.length,a=new Array(r>1?r-1:0),n=1;n<r;n++)a[n-1]=arguments[n];for(let s=0;s<3;s++)try{const e=new AbortController;b.current=e;const r=setTimeout((()=>{e.abort()}),1e4),n=await t(...a,{signal:e.signal});if(clearTimeout(r),Array.isArray(n)&&n.length>=0)return n;throw new Error("Invalid data format received")}catch(y){if(e=y,"AbortError"===y.name)throw y;s<2&&await new Promise((t=>setTimeout(t,1e3*Math.pow(2,s))))}throw e}),[]),_=(0,n.useCallback)((async function(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{let s;if(t||e){const r=new URLSearchParams;t&&r.append("city",t.trim()),e&&r.append("state",e.trim()),s="/php/api/rates/get_rates.php?".concat(r.toString())}else s="/php/api/rates/get_latest_rates.php";g>0&&(s=k(s));const c={signal:r.signal,headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}};t||e||(c.method="POST",c.headers["Content-Type"]="application/json",c.body=JSON.stringify([]));const o=await fetch(s,c);if(!o.ok)throw new Error("HTTP error! status: ".concat(o.status));const l=await o.text();if(!l.trim())return[];let i;try{i=JSON.parse(l)}catch(n){throw new Error("Invalid JSON response: ".concat(n.message))}if(i&&i.error)throw new Error(i.error);return i&&i.message&&!Array.isArray(i)?[]:Array.isArray(i)?i.map((t=>{const e=parseFloat(t.rate);return(0,a.A)((0,a.A)({},t),{},{rate:isNaN(e)?0:e})})):[]}catch(y){throw y}}),[g]),v=(0,n.useCallback)((async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let e="/php/api/rates/get_special_rates.php";g>0&&(e=k(e));const r=await fetch(e,{signal:t.signal,headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(!r.ok)throw new Error("HTTP error! status: ".concat(r.status));const n=await r.json();return Array.isArray(n)?n.map((t=>(0,a.A)((0,a.A)({},t),{},{rate:parseFloat(t.rate)}))):[]}catch(y){throw y}}),[g]),E=(0,n.useCallback)((()=>{g<3&&(m((t=>t+1)),d(null))}),[g]),P=(0,n.useCallback)((async()=>{b.current&&b.current.abort();const t=Date.now();C.current=t,w(!0),d(null);try{let e=r,a=o;if(r&&!o)try{const t=await(0,s.Si)(r);t&&t.state&&(a=t.state,l(t.state))}catch(y){}if(C.current!==t)return;const[n,c]=await Promise.all([T(_,e,a),T(v)]);C.current===t&&(u(n||[]),p(c||[]),m(0))}catch(y){C.current===t&&(d(y),u([]),p([]))}finally{C.current===t&&(w(!1),A(!0))}}),[r,o,T,_,v]);return(0,n.useEffect)((()=>(P(),()=>{b.current&&b.current.abort()})),[r,o,g,P]),(0,n.useEffect)((()=>{}),[g]),{selectedCity:r,selectedState:o,setSelectedCity:c,setSelectedState:l,eggRates:i,specialRates:h,loading:f,locationReady:S,error:y,retryCount:g,retryFetch:E,canRetry:g<3}}},9676:(t,e,r)=>{r.d(e,{$:()=>a});const a=t=>"N/A"===t||null===t||void 0===t?"N/A":"number"===typeof t?t.toFixed(2):t}}]);