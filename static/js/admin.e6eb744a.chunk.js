"use strict";(self.webpackChunkfood_price_app=self.webpackChunkfood_price_app||[]).push([[884],{455:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var s=a(5043),r=a(3216),n=a(579);const o=e=>{let{setIsAuthenticated:t}=e;const[a,o]=(0,s.useState)(""),[l,i]=(0,s.useState)(""),d=(0,r.Zp)();return(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-r from-blue-500 to-purple-600 p-4 sm:p-6 lg:p-8",children:(0,n.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-md",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-6 text-center text-gray-800",children:"Login"}),(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),"lokeshsinghsodha28"===a&&"Sodha@111"===l?(t(!0),d("/admin")):alert("Invalid credentials")},children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",htmlFor:"username",children:"Username"}),(0,n.jsx)("input",{id:"username",type:"text",placeholder:"Enter your username",value:a,onChange:e=>o(e.target.value),className:"mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition duration-200"})]}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",htmlFor:"password",children:"Password"}),(0,n.jsx)("input",{id:"password",type:"password",placeholder:"Enter your password",value:l,onChange:e=>i(e.target.value),className:"mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition duration-200"})]}),(0,n.jsx)("button",{type:"submit",className:"w-full py-2 px-4 bg-indigo-600 text-white font-bold rounded-md shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-200",children:"Login"}),(0,n.jsx)("div",{className:"mt-4 text-center",children:(0,n.jsx)("a",{href:"/forgot-password",className:"text-indigo-600 hover:text-indigo-700 transition duration-200",children:"Forgot Password?"})})]})]})})}},9529:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var s=a(5043),r=a(4672),n=a(3216),o=a(5475),l=a(579);const i=e=>{let{setIsAuthenticated:t}=e;const a=(0,n.Zp)();return(0,l.jsx)("nav",{className:"bg-gray-800 p-4 shadow-lg",children:(0,l.jsxs)("div",{className:"container mx-auto flex justify-between items-center",children:[(0,l.jsx)("div",{children:(0,l.jsx)(o.N_,{to:"/admin",className:"text-white text-2xl font-bold",children:"Admin Dashboard"})}),(0,l.jsx)("div",{className:"flex space-x-4",children:(0,l.jsx)("button",{onClick:()=>{t(!1),a("/login")},className:"text-white bg-red-600 hover:bg-red-700 px-4 py-2 rounded transition duration-150 ease-in-out",children:"Logout"})})]})})},d=e=>{let{states:t,selectedState:a,handleStateChange:s}=e;return(0,l.jsx)(r.Ay,{options:t,value:a,onChange:s,className:"w-full mb-4",placeholder:"Select State"})};var c=a(9379);const u=e=>{let{options:t,selectedOptions:a,setSelectedOptions:s}=e;const n=Array.from(new Set(t.map((e=>e.value)))).map((e=>t.find((t=>t.value===e))));return(0,l.jsx)(r.Ay,{isMulti:!0,options:n,value:a,onChange:s,className:"w-full",styles:{control:e=>(0,c.A)((0,c.A)({},e),{},{backgroundColor:"white",borderColor:"transparent",boxShadow:"none","&:hover":{borderColor:"transparent"},padding:"0.5rem",borderRadius:"0.375rem"}),menu:e=>(0,c.A)((0,c.A)({},e),{},{zIndex:9999}),placeholder:e=>(0,c.A)((0,c.A)({},e),{},{color:"#A0AEC0"})},placeholder:"Select Cities, States"})},h=e=>{let{eggRate:t,setEggRate:a,handleSubmit:s,handleSelectAll:r,handleCopyPreviousRates:n}=e;return(0,l.jsxs)("form",{onSubmit:s,className:"mb-6 grid grid-cols-1 gap-4",children:[(0,l.jsx)("button",{type:"button",onClick:r,className:"bg-green-600 text-white p-3 rounded w-full hover:bg-green-700 transition",children:"Select All Cities"}),(0,l.jsx)("input",{type:"date",value:t.date,onChange:e=>a((0,c.A)((0,c.A)({},t),{},{date:e.target.value})),className:"border border-gray-300 p-3 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500 transition",required:!0}),(0,l.jsx)("input",{type:"number",placeholder:"Rate",value:t.rate,onChange:e=>a((0,c.A)((0,c.A)({},t),{},{rate:e.target.value})),className:"border border-gray-300 p-3 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500 transition",required:!0}),(0,l.jsx)("button",{type:"submit",className:"bg-blue-600 text-white p-3 rounded w-full hover:bg-blue-700 transition",children:"Update Rates"}),(0,l.jsx)("button",{type:"button",onClick:n,className:"bg-yellow-600 text-white p-3 rounded w-full hover:bg-yellow-700 transition",children:"Copy Previous Rates"})]})},p=e=>{let{newState:t,setNewState:a,handleAddState:s}=e;return(0,l.jsxs)("form",{onSubmit:s,className:"mb-6 grid grid-cols-1 gap-4",children:[(0,l.jsx)("input",{type:"text",placeholder:"New State",value:t,onChange:e=>a(e.target.value),className:"border border-gray-300 p-3 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500 transition",required:!0}),(0,l.jsx)("button",{type:"submit",className:"bg-blue-600 text-white p-3 rounded w-full hover:bg-blue-700 transition",children:"Add State"})]})},g=e=>{let{states:t,newCity:a,setNewCity:s,newCityState:n,setNewCityState:o,handleAddCity:i}=e;return(0,l.jsxs)("form",{onSubmit:i,className:"mb-6 grid grid-cols-1 gap-4",children:[(0,l.jsx)(r.Ay,{options:t,value:n,onChange:o,className:"w-full mb-4",placeholder:"Select State for New City"}),(0,l.jsx)("input",{type:"text",placeholder:"New City",value:a,onChange:e=>s(e.target.value),className:"border border-gray-300 p-3 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500 transition",required:!0}),(0,l.jsx)("button",{type:"submit",className:"bg-blue-600 text-white p-3 rounded w-full hover:bg-blue-700 transition",children:"Add City"})]})},m=e=>{let{sortedEggRates:t,handleSort:a,setEggRate:r,handleDelete:n,handleEditRate:o}=e;const[i,d]=(0,s.useState)(null),[u,h]=(0,s.useState)({}),p=()=>{o(u),d(null)},g=()=>{d(null),h({})},m=e=>{const{name:t,value:a}=e.target;h((e=>(0,c.A)((0,c.A)({},e),{},{[t]:a})))};return(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full bg-white border border-gray-300",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-gray-200",children:[(0,l.jsx)("th",{className:"border border-gray-300 p-3 text-left cursor-pointer",onClick:()=>a("city"),children:"City"}),(0,l.jsx)("th",{className:"border border-gray-300 p-3 text-left cursor-pointer",onClick:()=>a("state"),children:"State"}),(0,l.jsx)("th",{className:"border border-gray-300 p-3 text-left cursor-pointer",onClick:()=>a("date"),children:"Date"}),(0,l.jsx)("th",{className:"border border-gray-300 p-3 text-left cursor-pointer",onClick:()=>a("rate"),children:"Rate"}),(0,l.jsx)("th",{className:"border border-gray-300 p-3 text-left",children:"Actions"})]})}),(0,l.jsx)("tbody",{children:t.map((e=>(0,l.jsxs)("tr",{className:"hover:bg-gray-100",children:[(0,l.jsx)("td",{className:"border border-gray-300 p-3",children:e.city}),(0,l.jsx)("td",{className:"border border-gray-300 p-3",children:e.state}),(0,l.jsx)("td",{className:"border border-gray-300 p-3",children:i===e.id?(0,l.jsx)("input",{type:"date",name:"date",value:u.date,onChange:m,className:"border border-gray-300 p-2 rounded w-full"}):e.date}),(0,l.jsx)("td",{className:"border border-gray-300 p-3",children:i===e.id?(0,l.jsx)("input",{type:"number",name:"rate",value:u.rate,onChange:m,className:"border border-gray-300 p-2 rounded w-full"}):"$".concat(e.rate)}),(0,l.jsx)("td",{className:"border border-gray-300 p-3 flex space-x-2",children:i===e.id?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{onClick:p,className:"bg-green-500 text-white p-2 rounded hover:bg-green-600 transition",children:"Save"}),(0,l.jsx)("button",{onClick:g,className:"bg-gray-500 text-white p-2 rounded hover:bg-gray-600 transition",children:"Cancel"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{onClick:()=>(e=>{d(e.id),h(e)})(e),className:"bg-yellow-500 text-white p-2 rounded hover:bg-yellow-600 transition",children:"Edit"}),(0,l.jsx)("button",{onClick:()=>n(e),className:"bg-red-500 text-white p-2 rounded hover:bg-red-600 transition",children:"Delete"})]})})]},"".concat(e.city,"-").concat(e.state,"-").concat(e.date))))})]})})},b=e=>{let{setIsAuthenticated:t}=e;const a=(new Date).toISOString().split("T")[0],[n,o]=(0,s.useState)({date:a,rate:""}),[c,b]=(0,s.useState)([]),[y,x]=(0,s.useState)([]),[f,j]=(0,s.useState)([]),[v,S]=(0,s.useState)(!0),[N,w]=(0,s.useState)(null),[C,A]=(0,s.useState)({key:"city",direction:"ascending"}),[k,E]=(0,s.useState)([]),[R,_]=(0,s.useState)(null),[O,T]=(0,s.useState)(""),[P,D]=(0,s.useState)(""),[F,J]=(0,s.useState)(null),[I,q]=(0,s.useState)(""),[L,M]=(0,s.useState)(null),[U,Z]=(0,s.useState)(null),[z,$]=(0,s.useState)(a),B=(0,s.useCallback)((()=>{S(!0),fetch("/php/api/rates/get_all_rates.php?date=".concat(z)).then((e=>e.json())).then((e=>{j(e),S(!1)})).catch((e=>{console.error("Error fetching rates:",e),w(e),S(!1)}))}),[z]),G=(0,s.useCallback)((()=>{fetch("/php/api/location/get_states_and_cities.php").then((e=>e.json())).then((e=>{const t=[],a=[];for(const s in e)a.push({value:s,label:s}),t.push({value:s,label:s,type:"state"}),e[s].forEach((e=>{t.push({value:"".concat(e,"-").concat(s),label:"".concat(e,", ").concat(s),type:"city"})}));x(t),E(a)})).catch((e=>console.error("Error fetching states and cities:",e)))}),[]);(0,s.useEffect)((()=>{B()}),[B]),(0,s.useEffect)((()=>{G()}),[G]);const H=s.useMemo((()=>{let e=[...f];return e.sort(((e,t)=>e[C.key]<t[C.key]?"ascending"===C.direction?-1:1:e[C.key]>t[C.key]?"ascending"===C.direction?1:-1:0)),e}),[f,C]),K=()=>{o({date:a,rate:""}),b([]),_(null),q(""),M(null),Z(null),T(""),D(""),J(null)};return v?(0,l.jsx)("div",{children:"Loading..."}):N?(0,l.jsxs)("div",{children:["Error loading data: ",N.message]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i,{setIsAuthenticated:t}),(0,l.jsx)("div",{className:"p-6 bg-gray-100 min-h-screen",children:(0,l.jsxs)("div",{className:"max-w-4xl mx-auto bg-white p-8 rounded-lg shadow-md",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold mb-6 text-center text-blue-600",children:"Admin Egg Rate Management"}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)(d,{states:k,selectedState:R,handleStateChange:e=>{_(e),b([]);const t=y.filter((t=>"city"===t.type&&t.label.includes(e.value)));b(t)}}),(0,l.jsx)(u,{options:y,selectedOptions:c,setSelectedOptions:b}),(0,l.jsx)(h,{eggRate:n,setEggRate:o,handleSubmit:e=>{e.preventDefault();const t=c.map((e=>{const[t,a]="city"===e.type?e.label.split(", "):[null,e.value];return{city:t,state:a||"",date:n.date,rate:n.rate,type:e.type}}));fetch("/php/api/rates/update_multiple_rates.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.json())).then((e=>{B(),K()})).catch((e=>console.error("Error submitting data:",e)))},handleSelectAll:()=>{const e=y.filter((e=>"city"===e.type));b(e)},handleCopyPreviousRates:()=>{if(0===c.length)return void alert("Please select at least one city.");(async()=>{const e=c.filter((e=>"city"===e.type)).map((e=>{const[t,a]=e.label.split(", ");return{city:t,state:a}}));console.log("Selected cities for updating rates:",e);const t=await(async e=>{console.log("Fetching latest rates for cities:",e);const t=await fetch("/php/api/rates/get_latest_rates.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await t.json();return console.log("Fetched latest rates:",a),a})(e),a=t.map((e=>({city:e.city,state:e.state,date:n.date,rate:e.rate||n.rate,type:"city"})));console.log("Payload for updating rates:",a),fetch("/php/api/rates/update_multiple_rates.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((e=>e.json())).then((e=>{console.log("Response from updating rates:",e),B(),K()})).catch((e=>console.error("Error submitting data:",e)))})()}}),(0,l.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-blue-600",children:"Add New State"}),(0,l.jsx)(p,{newState:O,setNewState:T,handleAddState:e=>{e.preventDefault(),fetch("/php/api/location/add_state_city.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"state",name:O})}).then((e=>e.json())).then((e=>{e.success?(G(),T("")):alert(e.error)})).catch((e=>console.error("Error adding state:",e)))}}),(0,l.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-blue-600",children:"Add New City"}),(0,l.jsx)(g,{states:k,newCity:P,setNewCity:D,newCityState:F,setNewCityState:J,handleAddCity:e=>{e.preventDefault(),fetch("/php/api/location/add_state_city.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"city",name:P,state:F.value})}).then((e=>e.json())).then((e=>{e.success?(G(),D(""),J(null)):alert(e.error)})).catch((e=>console.error("Error adding city:",e)))}}),(0,l.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-blue-600",children:"Remove State"}),(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault(),fetch("/php/api/location/remove_state_city.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"state",name:I})}).then((e=>e.json())).then((e=>{e.success?(G(),q("")):alert(e.error)})).catch((e=>console.error("Error removing state:",e)))},className:"mb-6 grid grid-cols-1 gap-4",children:[(0,l.jsx)(r.Ay,{options:k,value:k.find((e=>e.value===I)),onChange:e=>q(e.value),className:"w-full mb-4",placeholder:"Select State to Remove"}),(0,l.jsx)("button",{type:"submit",className:"bg-red-600 text-white p-3 rounded w-full hover:bg-red-700 transition",children:"Remove State"})]}),(0,l.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-blue-600",children:"Remove City"}),(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault(),fetch("/php/api/location/remove_state_city.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"city",name:L.label.split(", ")[0],state:U.value})}).then((e=>e.json())).then((e=>{e.success?(G(),M(null),Z(null)):alert(e.error)})).catch((e=>console.error("Error removing city:",e)))},className:"mb-6 grid grid-cols-1 gap-4",children:[(0,l.jsx)(r.Ay,{options:k,value:k.find((e=>e.value===(null===U||void 0===U?void 0:U.value))),onChange:Z,className:"w-full mb-4",placeholder:"Select State for City to Remove"}),(0,l.jsx)(r.Ay,{options:y.filter((e=>"city"===e.type&&e.label.includes(null===U||void 0===U?void 0:U.value))),value:L,onChange:M,className:"w-full mb-4",placeholder:"Select City to Remove"}),(0,l.jsx)("button",{type:"submit",className:"bg-red-600 text-white p-3 rounded w-full hover:bg-red-700 transition",children:"Remove City"})]}),(0,l.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-blue-600",children:"Current Egg Rates"}),(0,l.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"date",children:"Select Date"}),(0,l.jsx)("input",{type:"date",id:"date",value:z,onChange:e=>$(e.target.value),className:"border border-gray-300 p-3 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500 transition"})]}),(0,l.jsx)(m,{sortedEggRates:H,handleSort:e=>{let t="ascending";C.key===e&&"ascending"===C.direction&&(t="descending"),A({key:e,direction:t})},setEggRate:o,handleDelete:e=>{fetch("/php/api/rates/delete_rate.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id})}).then((e=>e.json())).then((e=>{B()})).catch((e=>console.error("Error deleting item:",e)))},handleEditRate:e=>{const t=f.map((t=>t.id===e.id?e:t));j(t),fetch("/php/api/rates/update_rate.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{e.success?B():console.error("Error updating rate:",e.error)})).catch((e=>console.error("Error updating rate:",e)))}})]})})]})}}}]);
//# sourceMappingURL=admin.e6eb744a.chunk.js.map